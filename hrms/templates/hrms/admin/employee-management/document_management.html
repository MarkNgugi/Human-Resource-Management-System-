{% extends 'hrms/admin/base.html' %}

{% block content %}
    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <div class="card shadow-lg">
                    <div class="card-header bg-primary text-white">
                        <h4>Document Management</h4>
                        <p>Select an employee and department to manage documents</p>
                    </div>
                    <div class="card-body">

                        <!-- Employee and Department Filters -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="employeeSelect">Select Employee</label>
                                <select id="employeeSelect" class="form-control">
                                    <option value="">-- Select Employee --</option>
                                    <option value="1">John Doe</option>
                                    <option value="2">Jane Smith</option>
                                    <option value="3">Alice Johnson</option>
                                </select>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="departmentSelect">Select Department</label>
                                <select id="departmentSelect" class="form-control">
                                    <option value="">-- Select Department --</option>
                                    <option value="admin">Admin</option>
                                    <option value="hr">HR</option>
                                    <option value="it">IT</option>
                                </select>
                            </div>
                        </div>

                        <!-- Search Button -->
                        <div class="row">
                            <div class="col-12 text-right">
                                <button class="btn btn-info" id="searchBtn">Search</button>
                            </div>
                        </div>

                        <!-- Filter Section with Documents -->
                        <div id="documentSection" style="display:none;">
                            <h5 class="text-primary mt-4">Documents for <span id="employeeName">John Doe</span></h5>

                            <!-- Document Categories Tabs -->
                            <ul class="nav nav-pills mb-3" id="documentTabs">
                                <li class="nav-item">
                                    <a class="nav-link active" id="resumeTab" data-toggle="pill" href="#resumes">Resumes</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="contractsTab" data-toggle="pill" href="#contracts">Contracts</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="certificatesTab" data-toggle="pill" href="#certificates">Certificates</a>
                                </li>
                            </ul>

                            <!-- Tab Content Section -->
                            <div class="tab-content" id="documentContent">
                                <div class="tab-pane fade show active" id="resumes">
                                    <!-- Resumes -->
                                    <div class="row" id="resumeCards">
                                        <!-- Dynamic Document Cards -->
                                    </div>
                                </div>

                                <div class="tab-pane fade" id="contracts">
                                    <!-- Contracts -->
                                    <div class="row" id="contractCards">
                                        <!-- Dynamic Document Cards -->
                                    </div>
                                </div>

                                <div class="tab-pane fade" id="certificates">
                                    <!-- Certificates -->
                                    <div class="row" id="certificateCards">
                                        <!-- Dynamic Document Cards -->
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Modal for Uploading Documents -->
                <div class="modal fade" id="uploadModal" tabindex="-1" role="dialog" aria-labelledby="uploadModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="uploadModalLabel">Upload Document</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <form method="POST" enctype="multipart/form-data">
                                {% csrf_token %}
                                <div class="modal-body">
                                    <div class="form-group">
                                        <label for="documentTitle">Document Title</label>
                                        <input type="text" class="form-control" id="documentTitle" name="documentTitle" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="documentFile">Upload File</label>
                                        <input type="file" class="form-control-file" id="documentFile" name="documentFile" required>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-primary">Upload</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript to Simulate Document Display -->
    <script>
        // Simulated Document Data
        const documents = {
            resumes: [
                { title: 'Resume of John Doe', updated: '2024-01-15' },
                { title: 'Resume of Jane Smith', updated: '2024-02-22' },
                { title: 'Resume of Alice Johnson', updated: '2024-03-10' },
                { title: 'Resume of Bob Brown', updated: '2024-04-05' }
            ],
            contracts: [
                { title: 'Contract for John Doe', updated: '2024-03-01' },
                { title: 'Contract for Alice Johnson', updated: '2024-04-10' }
            ],
            certificates: [
                { title: 'Certificate for John Doe', updated: '2023-11-30' },
                { title: 'Certificate for Jane Smith', updated: '2024-05-20' },
                { title: 'Certificate for Alice Johnson', updated: '2024-06-11' }
            ]
        };

        // Event listener for the search button
        document.getElementById('searchBtn').addEventListener('click', function () {
            document.getElementById('documentSection').style.display = 'block';
            const selectedEmployee = document.getElementById('employeeSelect').value;
            const selectedDepartment = document.getElementById('departmentSelect').value;

            // Update employee name (just for simulation purposes)
            document.getElementById('employeeName').innerText = selectedEmployee ? selectedEmployee : 'John Doe';

            // Clear previous cards
            document.getElementById('resumeCards').innerHTML = '';
            document.getElementById('contractCards').innerHTML = '';
            document.getElementById('certificateCards').innerHTML = '';

            // Generate cards for resumes, contracts, and certificates
            generateDocumentCards('resumes');
            generateDocumentCards('contracts');
            generateDocumentCards('certificates');
        });

        function generateDocumentCards(type) {
            const container = document.getElementById(type + 'Cards');
            const docs = documents[type];

            docs.forEach(doc => {
                const card = document.createElement('div');
                card.className = 'col-md-4 mb-3';

                card.innerHTML = `
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">${doc.title}</h5>
                            <p class="card-text">Last updated: ${doc.updated}</p>
                            <a href="#" class="btn btn-primary btn-sm">View</a>
                        </div>
                    </div>
                `;

                container.appendChild(card);
            });
        }
    </script>

{% endblock %}
